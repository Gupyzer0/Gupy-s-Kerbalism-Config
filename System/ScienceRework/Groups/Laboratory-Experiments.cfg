// ============================================================================
// Patching all parts that have a Laboratory Module.
// ============================================================================
// adding the experiments, patching the SETUPs and the experiment parameters 
// based on values from the relevant config in the tweakables folder.

// ----------------------------------------------------------------------------
// Experiment Values
// ----------------------------------------------------------------------------
// Lab exclusive experiments (with the exception of goo and matbay).
// tried to cover most situations (landed, orbital, underwater, flying)
// makes the labs have a purpose again.
// I preffer for the labs to require scientists at varying levels present at all times to do the experiments.
// high ec requirements are appropriate imo, adds a requirement to design stuff properly.
@KERBALISM_GROUP_SETTINGS:NEEDS[FeatureScience]
{
	LAB_EXPERIMENTS
	{
		BaseSlots = 1
		UpgradeTech = spaceStations8
		UpgradedSlots = 2
		UpgradeEntryCost = 35000
		ReconfigureTech = fieldScience				//lab has a upgrade that allows reconfiguration in the field. these 2 handle the requirements for that to happen
		ReconfigureRequirement = Scientist:5
		ReconfigureEntryCost = 65000
		LabDataRateMultiplier = 2					// Duration reduction for labs.
		LabECMultiplier = 5							// EC Cost multiplier
		LabSampleReservoirMultiplier = 2			// for experiments that have sampling reservoirs.

		Spacelines_LongDurationHabit1
		{
			ECCost = 0.1
			size = 25
			value = 750
			duration = 15552000 // 180 days
			SetupMass = 0.01
			SetupCost = 
			UnlockTech = 
			requirements = CrewMin:2
			ResourceRates =
			CrewRequirement = True
		}

		// MOL

		Spacelines_UltravioletRadiationOrthicon
		{
			ECCost = 0.001
			size = 1.9656
			value = 120 
			duration = 518400 // 6 days
			SetupMass = 0.02
			SetupCost = 
			UnlockTech = spaceStations7
			requirements = CrewMin:1
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_AirglowHorizonSpectroscopy
		{
			ECCost = 0.001
			size = 0.001
			value = 120
			duration = 21600 // 6 hours
			SetupMass = 0.02
			SetupCost = 
			UnlockTech = spaceStations7
			requirements = CrewMin:1,SunAngleMin:0,SunAngleMax:60 // Necessitates a ray through athmosphere
			ResourceRates =
			CrewRequirement = True
		}	

		Spacelines_OceanSurveillance
		{
			ECCost = 0.001
			size = 20
			value = 350
			duration = 2592000 // 30 days
			SetupMass = 0.02
			SetupCost = 
			UnlockTech = spaceStations7
			requirements = CrewMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_NarrowBeamRadioCommunication
		{
			ECCost = 0.0001
			size = 0.00005625
			value = 150
			duration = 86400 // 1 day
			SetupMass = 0.03
			SetupCost = 
			UnlockTech = spaceStations7
			requirements = CrewMin:2,TrackingStationLevelMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_NarrowBeamLaserCommunication
		{
			ECCost = 0.0005
			size = 0.001
			value = 150
			duration = 86400 // 1 day
			SetupMass = 0.07
			SetupCost = 
			UnlockTech = spaceStations7
			requirements = CrewMin:2,TrackingStationLevelMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_VaporDistillationWaterPurification
		{
			ECCost = 0.000075
			size = 1
			value = 100
			duration = 604800 // 7 days
			SetupMass = 0.02
			SetupCost = 
			UnlockTech = spaceStations7
			requirements = CrewMin:2
			ResourceRates = WasteWater@0.000045
			CrewRequirement = True
		}

		Spacelines_SolarXRayDetection
		{
			ECCost = 0.01
			size = 1
			value = 150
			duration = 2592000 // 30 days
			SetupMass = 0.0045 
			SetupCost = 
			UnlockTech = spaceStations7
			requirements = CrewMin:1,Sunlight
			ResourceRates =
			CrewRequirement = True
		}

		// Skylab
		Spacelines_LongDurationHabit2
		{
			ECCost = 0.5
			size = 50
			value = 1500
			duration = 63072000 // 2 years
			SetupMass = 0
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3
			ResourceRates = 
			CrewRequirement = True
		}

		Spacelines_NuclearEmulsion
		{
			ECCost = 0.015
			size = 1
			value = 200
			duration = 1814400 // 21 days
			SetupMass = 
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_UVAirglowHorizonPhotography
		{
			ECCost = 0.1
			size = 1
			value = 200
			duration = 2592000 // 30 days
			SetupMass = 
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3,SunAngleMin:0,SunAngleMax:60
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_ParticleCollection
		{
			ECCost = 0.116
			size = 1
			value = 200
			duration = 2592000 // 30 days
			SetupMass = 
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_GnatMiceCircadianRhythm
		{
			ECCost = 0.120
			size = 1
			value = 200
			duration = 2419200 // 28 days
			SetupMass = 
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_GalacticXRayMapping
		{
			ECCost = 0.5
			size = 1
			value = 200
			duration = 2592000 // 30 days
			SetupMass = 
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_ZeroGFlammability
		{
			ECCost = 0.028
			size = 1
			value = 200
			duration = 18000 // 5 hours
			SetupMass = 
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_CompositeCasting
		{
			ECCost = 0.1
			size = 1
			value = 100
			duration = 21600 // 6 hours
			SetupMass = 
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_GalliumArsenideCrystalGrowth
		{
			ECCost = 0.1
			size = 1
			value = 200
			duration = 414000 // 115 hours
			SetupMass = 
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3
			ResourceRates =
			CrewRequirement = True
		}

		Spacelines_EarthResourcesExperimentPackage
		{
			ECCost = 1.1
			size = 1
			value = 200
			duration = 7776000 // 90 days
			SetupMass = 
			SetupCost = 
			UnlockTech = spaceStations8
			requirements = CrewMin:3
			ResourceRates =
			CrewRequirement = True
		}		
	}
}

// ----------------------------------------------------------------------------
// Kerbalism Config
// ----------------------------------------------------------------------------

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_LongDurationHabit1]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_LongDurationHabit1/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_LongDurationHabit1/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0

		Situation = Space
		BodyAllowed = HomeBody
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_UltravioletRadiationOrthicon]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_UltravioletRadiationOrthicon/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_UltravioletRadiationOrthicon/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0

		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_AirglowHorizonSpectroscopy]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_AirglowHorizonSpectroscopy/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_AirglowHorizonSpectroscopy/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_OceanSurveillance]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_OceanSurveillance/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_OceanSurveillance/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_NarrowBeamRadioCommunication]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_NarrowBeamRadioCommunication/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_NarrowBeamRadioCommunication/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_NarrowBeamLaserCommunication]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_NarrowBeamLaserCommunication/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_NarrowBeamLaserCommunication/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_VaporDistillationWaterPurification]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_VaporDistillationWaterPurification/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_VaporDistillationWaterPurification/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_SolarXRayDetection]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_SolarXRayDetection/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_SolarXRayDetection/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_LongDurationHabit2]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_LongDurationHabit2/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_LongDurationHabit2/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = Space
		IncludeExperiment = Spacelines_LongDurationHabit1
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_NuclearEmulsion]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_NuclearEmulsion/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_NuclearEmulsion/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_UVAirglowHorizonPhotography]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_UVAirglowHorizonPhotography/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_UVAirglowHorizonPhotography/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_ParticleCollection]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_ParticleCollection/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_ParticleCollection/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		// sample mass in tons. if undefined or 0, the experiment produce a file
		SampleMass = 0.005 //Placeholder
		// Body restrictions, multiple lines allowed (just don't use confictiong combinations).
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment = 
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_GnatMiceCircadianRhythm]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GnatMiceCircadianRhythm/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GnatMiceCircadianRhythm/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		SampleMass = 0
		
		BodyAllowed = HomeBody
		Situation = InSpaceLow
		IncludeExperiment =
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_GalacticXRayMapping]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GalacticXRayMapping/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GalacticXRayMapping/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_ZeroGFlammability]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_ZeroGFlammability/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_ZeroGFlammability/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_CompositeCasting]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_CompositeCasting/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_CompositeCasting/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_GalliumArsenideCrystalGrowth]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GalliumArsenideCrystalGrowth/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GalliumArsenideCrystalGrowth/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		
	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_EarthResourcesExperimentPackage]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_EarthResourcesExperimentPackage/value$
	@dataScale = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_EarthResourcesExperimentPackage/size$
	@dataScale /= #$baseValue$

  	KERBALISM_EXPERIMENT
	{
		
	}
}


// Adding the relevant experiment modules
@PART[*]:HAS[@MODULE[Configure]:HAS[#title[Laboratory?Experiments]],!MODULE[Experiment]:HAS[#experiment_id[mobileMaterialsLab]]]:NEEDS[FeatureScience]
{
//removing stock experiments to avoid duplicates. they get added through SETUPs, unlocked at stock tech.
	!MODULE[Experiment]:HAS[#experiment_id[mobileMaterialsLab]]	{}

	MODULE
	{
		name = Experiment
		experiment_id = mobileMaterialsLab
	}
}

@PART[*]:HAS[@MODULE[Configure]:HAS[#title[Laboratory?Experiments]],!MODULE[Experiment]:HAS[#experiment_id[mysteryGoo]]]:NEEDS[FeatureScience]
{
//removing stock experiments to avoid duplicates. they get added through SETUPs, unlocked at stock tech.
	!MODULE[Experiment]:HAS[#experiment_id[mysteryGoo]]{}

	MODULE
	{
		name = Experiment
		experiment_id = mysteryGoo
	}
}

@PART[*]:HAS[@MODULE[Configure]:HAS[#title[Laboratory?Experiments]]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{

	LongDurationHabit1
	Spacelines_UltravioletRadiationOrthicon
	Spacelines_AirglowHorizonSpectroscopy
	Spacelines_OceanSurveillance
	Spacelines_NarrowBeamRadioCommunication
	Spacelines_NarrowBeamLaserCommunication
	Spacelines_VaporDistillationWaterPurification
	Spacelines_SolarXRayDetection
	Spacelines_LongDurationHabit2
	Spacelines_NuclearEmulsion
	Spacelines_UVStellarAstronomy
	Spacelines_UVAirglowHorizonPhotography
	Spacelines_ParticleCollection
	Spacelines_UVPanorama
	Spacelines_GnatMiceCircadianRhythm
	Spacelines_GalacticXRayMapping
	Spacelines_ZeroGFlammability
	Spacelines_CompositeCasting
	Spacelines_GalliumArsenideCrystalGrowth
	Spacelines_EarthResourcesExperimentPackage
	

	// ------------------------------------------------------------------------
	// Adding the Configure module to handle the experiment selection, together
	// with the corresponding setups.
	// ------------------------------------------------------------------------
	@MODULE[Configure]:HAS[#title[Laboratory?Experiments]]
	{
		SETUP
		{
			name = None
			desc = Empty slot for mass and cost savings, should you not require any experiments installed.
		}
		SETUP
		{
			name = Materials Bay Study
			desc = Install a SC-9001 Science Jr. Materials Bay in the Laboratory, allowing on-board scientists to study the behaviour of "materials" in different environments.
			MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = mobileMaterialsLab
			}
		}
		SETUP
		{
			name = Mystery Goo Observation
			desc = Install a Mystery Goo Containment Unit in the Laboratory, allowing on-board scientists to study the behaviour of the Goo in different environments.
			MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = mysteryGoo
			}
		}
		SETUP
		{
			name = JAMMED
			desc = Justified Analysis of Meticulous Mindfulness while Extruding Data: Basically just early general scientific research.
			MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = Spacelines_JAMMED
			}
		}
		SETUP
		{
			name = BIRDIE
			desc = Biome Investigation Retconning Deep Investigations at Elevation: Analyzing biomes from high above, but not space high of course.
			MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = Spacelines_BIRDIE
			}
		}
		SETUP
		{
			name = SALINE
			desc = Sea Alkalinity Longterm Investigation to Neutralise Environment: Overly salted Kerbal Scientists investigate ways to neutralise the water.
			MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = Spacelines_SALINE
			}
		}
		SETUP
		{
			name = CHILLED
			desc = Chlorophyl Horticulture In Lived Laboratory Experimental Determinations:  Scientists will spend time watching grass grow for science.
			MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = Spacelines_CHILLED
			}
		}
		SETUP
		{
			name = AEDGE
			desc = Advanced General Studies: Got an experiment to do in microgravity? we can doit for you with this module.
			MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = Spacelines_GeneralStudies
			}
		}
		SETUP
		{
			name = RELAX
			desc = Regolith Experiential Laboratory Analysis eXplanation:  Scientists will spend time developing a meaningful relationship with the local regolith.
			MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = Spacelines_RELAX
			}
		}
	}
}
// ============================================================================
// the experiments were just added above, but not configured. This section takes care of that

@PART[*]:HAS[@MODULE[Configure]:HAS[#title[Laboratory?Experiments]]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@MODULE[Configure]:HAS[#title[Laboratory?Experiments]]
	{
		%slots = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/BaseSlots$
		%reconfigure = false

		UPGRADES
		{
			UPGRADE
			{
				name__ = Lab-Upgrade1
				techRequired__ = #$../../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/UpgradeTech$
				slots = #$../../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/UpgradedSlots$
			}
			UPGRADE
			{
				name__ = Lab-Upgrade2
				techRequired__ = #$../../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/ReconfigureTech$
				reconfigure = #$../../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/ReconfigureRequirement$
			}
		}

		@SETUP:HAS[#name[Materials?Bay?Study]]
		{
			%tech = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mobileMaterialsLab/UnlockTech$
			%mass = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mobileMaterialsLab/SetupMass$
			%cost = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mobileMaterialsLab/SetupCost$
		}

		@SETUP:HAS[#name[Mystery?Goo?Observation]]
		{
			%tech = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mysteryGoo/UnlockTech$
			%mass = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mysteryGoo/SetupMass$
			%cost = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mysteryGoo/SetupCost$
		}

		@SETUP:HAS[#name[JAMMED]]
		{
			%tech = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/JAMMED/UnlockTech$
			%mass = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/JAMMED/SetupMass$
			%cost = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/JAMMED/SetupCost$
		}

		@SETUP:HAS[#name[BIRDIE]]
		{
			%tech = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/BIRDIE/UnlockTech$
			%mass = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/BIRDIE/SetupMass$
			%cost = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/BIRDIE/SetupCost$
		}

		@SETUP:HAS[#name[SALINE]]
		{
			%tech = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/SALINE/UnlockTech$
			%mass = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/SALINE/SetupMass$
			%cost = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/SALINE/SetupCost$
		}

		@SETUP:HAS[#name[CHILLED]]
		{
			%tech = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/CHILLED/UnlockTech$
			%mass = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/CHILLED/SetupMass$
			%cost = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/CHILLED/SetupCost$
		}

		@SETUP:HAS[#name[AEDGE]]
		{
			%tech = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GeneralStudies/UnlockTech$
			%mass = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GeneralStudies/SetupMass$
			%cost = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GeneralStudies/SetupCost$
		}

		@SETUP:HAS[#name[RELAX]]
		{
			%tech = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/RELAX/UnlockTech$
			%mass = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/RELAX/SetupMass$
			%cost = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/RELAX/SetupCost$
		}

		@SETUP:HAS[#name[COLODEMO]]
		{
			%tech = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_COLODEMO/UnlockTech$
			%mass = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_COLODEMO/SetupMass$
			%cost = #$../../@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_COLODEMO/SetupCost$
		}
	}

	@MODULE[Experiment]:HAS[#experiment_id[mobileMaterialsLab]]
	{
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mobileMaterialsLab//ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mobileMaterialsLab//CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mobileMaterialsLab//requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mobileMaterialsLab//size$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/LabDataRateMultiplier$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mobileMaterialsLab//duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mobileMaterialsLab//ResourceRates$
	}

	@MODULE[Experiment]:HAS[#experiment_id[mysteryGoo]]
	{
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mysteryGoo//ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mysteryGoo//CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mysteryGoo//requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mysteryGoo//size$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/LabDataRateMultiplier$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mysteryGoo//duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/mysteryGoo//ResourceRates$
	}

	@MODULE[Experiment]:HAS[#experiment_id[Spacelines_JAMMED]]
	{
		%ec_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/JAMMED/ECCost$
		%crew_operate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/JAMMED/CrewRequirement$
		%requires = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/JAMMED/requirements$
		%data_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/JAMMED/size$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/LabDataRateMultiplier$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/JAMMED/duration$
		%resources = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/JAMMED/ResourceRates$
	}

	@MODULE[Experiment]:HAS[#experiment_id[Spacelines_BIRDIE]]
	{
		%ec_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/BIRDIE/ECCost$
		%crew_operate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/BIRDIE/CrewRequirement$
		%requires = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/BIRDIE/requirements$
		%data_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/BIRDIE/size$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/BIRDIE/duration$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/LabDataRateMultiplier$
	}

	@MODULE[Experiment]:HAS[#experiment_id[Spacelines_SALINE]]
	{
		%ec_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/SALINE/ECCost$
		%crew_operate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/SALINE/CrewRequirement$
		%requires = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/SALINE/requirements$
		%data_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/SALINE/size$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/SALINE/duration$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/LabDataRateMultiplier$
		// %resources = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/SALINE/ResourceRates$
		%sample_collecting = True
	}

	@MODULE[Experiment]:HAS[#experiment_id[Spacelines_CHILLED]]
	{
		%ec_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/CHILLED/ECCost$
		%crew_operate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/CHILLED/CrewRequirement$
		%requires = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/CHILLED/requirements$
		%data_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/CHILLED/size$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/CHILLED/duration$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/LabDataRateMultiplier$
		%resources = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/CHILLED/ResourceRates$
	}

	@MODULE[Experiment]:HAS[#experiment_id[Spacelines_GeneralStudies]]
	{
		%ec_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GeneralStudies/ECCost$
		%crew_operate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GeneralStudies/CrewRequirement$
		%requires = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GeneralStudies/requirements$
		%data_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GeneralStudies/size$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/Spacelines_GeneralStudies/duration$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/LabDataRateMultiplier$
	}

	@MODULE[Experiment]:HAS[#experiment_id[Spacelines_RELAX]]
	{
		%ec_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/RELAX/ECCost$
		%crew_operate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/RELAX/CrewRequirement$
		%requires = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/RELAX/requirements$
		%data_rate = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/RELAX/size$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/RELAX/duration$
		@data_rate /= #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/LabDataRateMultiplier$
		%resources = #$@KERBALISM_GROUP_SETTINGS/LAB_EXPERIMENTS/RELAX/ResourceRates$
		%sample_collecting = True
	}
}
