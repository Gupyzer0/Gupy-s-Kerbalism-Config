// ============================================================================
// Biological Experiments Samples
// ============================================================================

// ----------------------------------------------------------------------------
// Experiment Values
// ----------------------------------------------------------------------------

@KERBALISM_EXPERIMENT_VALUES:NEEDS[FeatureScience]
{
	%SPACELINES
	{
        Spacelines_Bioexp1
		{
			ec_rate = 0.01
			size = 1
			value = 5
			duration = 1200 // 20mins
			requirements =
            SetupMass =
			SetupCost =
            UnlockTech = construction1
            ResourceRates = 
		}

		Spacelines_Bioexp2
		{
			ec_rate = 0.1
			size = 1
			value = 20
			duration = 86400 // 24 hours
			requirements = 
            SetupMass =
			SetupCost =
            UnlockTech = science2
            ResourceRates = 
		}
    }
}

// ----------------------------------------------------------------------------
// Kerbalism Config
// ----------------------------------------------------------------------------

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_Bioexp1]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
    @baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp1/value$
	@dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp1/size$
	@dataScale /= #$baseValue$

	RESULTS
    {
        default = Observations are recorded regarding the biological sample in the current conditions.
    }

    KERBALISM_EXPERIMENT
  	{
		// sample mass in tons. if undefined or 0, the experiment produce a file
		SampleMass = 0.0002
        // Body restrictions, multiple lines allowed (just don't use confictiong combinations).
	    BodyAllowed = HomeBody
        Situation = InSpaceLow
		Situation = InSpaceHigh
		IncludeExperiment = 
 	}
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_Bioexp2]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
    @baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp2/value$
	@dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp2/size$
	@dataScale /= #$baseValue$

	RESULTS
    {
        default = Observations are recorded regarding the organism in the current conditions.
    }
    KERBALISM_EXPERIMENT
  	{
        SampleMass = 0.01
        Situation = InSpaceLow
		Situation = InSpaceHigh
        BodyAllowed = HomeBody
        IncludeExperiment = Spacelines_Bioexp1
  	}
}

// ----------------------------------------------------------------------------
// Replacing Experiments with our own experiment
// ----------------------------------------------------------------------------

// Configure Module
@PART[*]:HAS[#Tag_Spacelines_Bioexp[True]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
    MODULE
    {
        name = Experiment
        experiment_id = Spacelines_Bioexp1
        
    }

    MODULE
    {
        name = Experiment
        experiment_id = Spacelines_Bioexp2
       
    }
    
    @MODULE[Configure]:HAS[#title[Unmanned?Experiments]]
	{

        SETUP
        {
            name = Biological Experiment One
            desc = Biological samples (fruit flies, fungus, frogs, perhaps even a mouse or two). While some observations of the sample may be transmitted, only by recovering the sample safely can the most information be gained about life's response to the given situation.

            MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = Spacelines_Bioexp1
			}
        }

        SETUP
        {
            name = Biological Experiment Two
            desc = Contains a monkey, or a small dog. Returning the sample is crucial for scientific and ethical reasons.

            MODULE
			{
				type = Experiment
				id_field = experiment_id
				id_value = Spacelines_Bioexp2
			}
        }
    }
}

// Using Experiment Values
@PART[*]:HAS[@MODULE[Configure]:HAS[#title[Unmanned?Experiments]]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@MODULE[Configure]:HAS[#title[Unmanned?Experiments]]
	{
		@SETUP:HAS[#name[Biological?Experiment?One]]
		{
			%tech = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp1/UnlockTech$
			%mass = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp1/SetupMass$
			%cost = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp1/SetupCost$
		}

        @SETUP:HAS[#name[Biological?Experiment?Two]]
		{
			%tech = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp2/UnlockTech$
			%mass = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp2/SetupMass$
			%cost = #$../../@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp2/SetupCost$
		}
    }

    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_Bioexp1]]
    {
        data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp1/size$
        @data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp1/duration$
        ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp1/ec_rate$
        allow_shrouded = True
        sample_amount = 1
    }
    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_Bioexp2]]
    {
        data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp2/size$
        @data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp2/duration$
        ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Bioexp2/ec_rate$
        allow_shrouded = True
        sample_amount = 1
    }	
}
