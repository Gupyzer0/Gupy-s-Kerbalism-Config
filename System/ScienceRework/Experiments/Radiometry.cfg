// ============================================================================
// Infrared Radiometry
// ============================================================================

// ----------------------------------------------------------------------------
// Experiment Values
// ----------------------------------------------------------------------------
@KERBALISM_EXPERIMENT_VALUES:NEEDS[FeatureScience]
{
	%SPACELINES
	{
		Spacelines_IRRadiometer
		{
			ECCost = 0.05
			size = 9
			value = 1
			duration = 21600 				
			requirements = Shadow
			ResourceRates =
			CrewRequirement = 
		}

		Spacelines_MicrowaweRadiometer
		{
			ECCost = 0.05
			size = 9						
			value = 1
			duration = 21600
			requirements = 
			ResourceRates =
			CrewRequirement = 
		}

		Spacelines_RadiationBudget
		{
			ECCost = 1
			size = 9
			value = 15
			duration = 1296000
			requirements = OrbitMinInclination:85
			ResourceRates =
			CrewRequirement = 
		}
	}
}

// ----------------------------------------------------------------------------
// Kerbalism Config
// ----------------------------------------------------------------------------

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_IRRadiometer]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/value$
	@dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/size$
	@dataScale /= #$baseValue$

    KERBALISM_EXPERIMENT
    {
		Situation = InSpaceHigh
		Situation = InSpaceLow@Biomes
    }
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_MicrowaweRadiometer]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/value$
	@dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/size$
	@dataScale /= #$baseValue$

    KERBALISM_EXPERIMENT
    {
		Situation = InSpaceHigh
		Situation = InSpaceLow@Biomes
    }
}

@EXPERIMENT_DEFINITION:HAS[#id[Spacelines_RadiationBudget]]:NEEDS[FeatureScience]:FOR[KerbalismDefault]
{
	@baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/value$
	@dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/size$
	@dataScale /= #$baseValue$

    KERBALISM_EXPERIMENT
    {
		BodyAllowed = Atmospheric
  		BodyNotAllowed = Suns

		Situation = InSpaceLow
    }
}

// ----------------------------------------------------------------------------
// Replacing Experiments with our own experiment
// ----------------------------------------------------------------------------

// Creating Experiment module
@PART[*]:HAS[#Tag_Spacelines_IRRadiometer[True]]:NEEDS[FeatureScience] {
	MODULE
    {
        name = Experiment
        experiment_id = Spacelines_IRRadiometer
    }
}

@PART[*]:HAS[#Tag_Spacelines_MicrowaweRadiometer[True]]:NEEDS[FeatureScience] {
	MODULE
    {
        name = Experiment
        experiment_id = Spacelines_MicrowaweRadiometer
    }
}

@PART[*]:HAS[#Tag_Spacelines_RadiationBudget[True]]:NEEDS[FeatureScience] {
	MODULE
    {
        name = Experiment
        experiment_id = Spacelines_RadiationBudget
    }
}

// Setting Experiment Values
@PART[*]:HAS[#Tag_Spacelines_IRRadiometer[True]]:NEEDS[FeatureScience] {
    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_IRRadiometer]] {
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/ResourceRates$
		allow_shrouded = False

		%experimentLength = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/duration$
		%experimentSize = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_IRRadiometer/size$
    }
}

@PART[*]:HAS[#Tag_Spacelines_MicrowaweRadiometer[True]]:NEEDS[FeatureScience] {
    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_MicrowaweRadiometer]] {
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/ResourceRates$
		allow_shrouded = False

		%experimentLength = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/duration$
		%experimentSize = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_MicrowaweRadiometer/size$
    }
}

@PART[*]:HAS[#Tag_Spacelines_RadiationBudget[True]]:NEEDS[FeatureScience] {
    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_RadiationBudget]] {
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/ResourceRates$
		allow_shrouded = False

		%experimentLength = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/duration$
		%experimentSize = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_RadiationBudget/size$
    }
}


// ----------------------------------------------------------------------------
// Animations
// ----------------------------------------------------------------------------

@PART[*]:HAS[#Tag_Spacelines_IRRadiometer[True],@MODULE:HAS[#animationName]]:NEEDS[FeatureScience]
{
	@MODULE[Experiment],*
	{
		%anim_deploy = #$../MODULE:HAS[#animationName,~name[Experiment]]/animationName$
	}
}

@PART[*]:HAS[#Tag_Spacelines_MicrowaweRadiometer[True],@MODULE:HAS[#animationName]]:NEEDS[FeatureScience]
{
	@MODULE[Experiment],*
	{
		%anim_deploy = #$../MODULE:HAS[#animationName,~name[Experiment]]/animationName$
	}
}

@PART[*]:HAS[#Tag_Spacelines_RadiationBudget[True],@MODULE:HAS[#animationName]]:NEEDS[FeatureScience]
{
	@MODULE[Experiment],*
	{
		%anim_deploy = #$../MODULE:HAS[#animationName,~name[Experiment]]/animationName$
	}
}
