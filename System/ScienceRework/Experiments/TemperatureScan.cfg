// ============================================================================
// Temperature Scan
// ============================================================================

// ----------------------------------------------------------------------------
// Experiment Values
// ----------------------------------------------------------------------------

@KERBALISM_EXPERIMENT_VALUES:NEEDS[FeatureScience]
{
	%SPACELINES
	{
        temperatureScan
		{
			ECCost = 0.0001						//all sensors will have very low EC/s consumption
			size = 0.45								//reasonably small scale, as it's a very early experiment
			value = 2									//nerfed value (8->3) due to it being an early unlock, left biome/situations unchanged
			duration = 10
			requirements =
			ResourceRates =
			UnlockTech = start
			SetupMass = 0
			SetupCost = 900
		}
    }
}

// ----------------------------------------------------------------------------
// Kerbalism Config
// ----------------------------------------------------------------------------

@EXPERIMENT_DEFINITION:HAS[#id[temperatureScan]]:NEEDS[FeatureScience]:FOR[zzzKerbalismDefault]
{
	@baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/temperatureScan/value$
	@dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/temperatureScan/size$
	@dataScale /= #$baseValue$

    KERBALISM_EXPERIMENT
    {
        Situation = Surface@Biomes
        Situation = FlyingLow@Biomes
        Situation = FlyingHigh
        Situation = InSpaceLow
        Situation = InSpaceHigh
    }
}

// Tagging
@PART[*]:HAS[@MODULE[*ModuleScience*]:HAS[#experimentID[temperatureScan]]]:NEEDS[FeatureScience]
{
    %Tag_temperatureScan = True
}

// Experiment module
@PART[*]:HAS[#Tag_temperatureScan[True]]:NEEDS[FeatureScience] {
    MODULE
	{
		name = Experiment
		experiment_id = temperatureScan
	}
}

// Setting Experiment Values

@PART[*]:HAS[#Tag_temperatureScan[True]]:NEEDS[FeatureScience] {
    @MODULE[Experiment]:HAS[#experiment_id[temperatureScan]] {
		%ec_rate = 0 // NO EC NEEDED FOR PASSIVE ONES
		//%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/temperatureScan/CrewRequirement$
		//%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/temperatureScan/requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/temperatureScan/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/temperatureScan/duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/temperatureScan/ResourceRates$
		
		%experimentLength = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/temperatureScan/duration$
		%experimentSize = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/temperatureScan/size$
    }
}

// ----------------------------------------------------------------------------
// Animations
// ----------------------------------------------------------------------------
@PART[*]:HAS[#Tag_temperatureScan[True],@MODULE:HAS[#animationName]]:NEEDS[FeatureScience]
{
	@MODULE[Experiment],*
	{
		%anim_deploy = #$../MODULE:HAS[#animationName,~name[Experiment]]/animationName$
	}
}

// ----------------------------------------------------------------------------
// Sensor
// ----------------------------------------------------------------------------
@PART[*]:HAS[!MODULE[Sensor]:HAS[#type[temperature]],@MODULE[Experiment]:HAS[#experiment_id[temperatureScan]]]:NEEDS[FeatureScience]:FOR[zzzKerbalismDefault]
{
	!MODULE[ModuleEnviroSensor] {}
	MODULE
	{
		name = Sensor
		type = temperature
	}
}