// Adds Aeroizine50 | NTO as hypergolic fuels for hypergolic using engines/tanks
// Basically BD_Extras Hypergolic BDB patch so all credits to Pappystein

// Add the fuel type to all tanks. Must be done at :AFTER[Bluedog_DB_1]
@PART[*]:HAS[@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]]:HAS[bdbTankType[!bdbBalloon]]]:FOR[zzzSpacelines]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]]
	{
		SUBTYPE
		{
			name = Hypergolic
			tankType = AZ50NTO
			addedMass = #$../../tank_mass$
			@addedMass *= -1
			addedCost = #$../../tank_plus_fuel_cost$
			@addedCost *= -1
			percentFilled = #$../../fuelPctFill$
		}
	}
}

// Adds B9ParSwitch Hypergolic Tank to those tanks without it
@PART[*]:HAS[#hypergolic_tank[True]]

// Engine and tank setup
@PART[*]:HAS[#hypergolic_engine[True]]:AFTER[zzzSpacelines]
{
	// Changes the default fuel
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]]
	{
		%currentSubtype = Hypergolic
	}
	
	// Only need to change name. 2.25:2.75 is the same as 0.9:1.1
	@MODULE[ModuleEngines*],*
	{
		@PROPELLANT[LiquidFuel]
		{
			@name = Aerozine50
		}
		@PROPELLANT[Oxidizer]
		{
			@name = NTO
		}
	}
	
	// Not present in tanks, but some engines have fuel onboard
	@RESOURCE[LiquidFuel]
	{
		@name = Aerozine50
		@amount *= 5
		@maxAmount *= 5
	}
	@RESOURCE[Oxidizer]
	{
		@name = NTO
		@amount *= 5
		@maxAmount *= 5
	}
}

//This code sets default fuel type for Hypergolic tanks to Hypergolic (whatever subvariant)
@PART[bluedog*,Bluedog*]:HAS[#hypergolic_tank[True]]:AFTER[zzzSpacelines]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]]
	{
		%currentSubtype = Hypergolic
	}
}

@PART[bluedog*,Bluedog*]:HAS[#hypergolic_tank[True]]:AFTER[zzzSpacelines]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]]
	{
		%currentSubtype = Hypergolic
	}
}
// Cleanup for all bdbVariables is in base B9PartSwitchTanks file
// Monococue stuff
// @PART[bluedog*,Bluedog*]:HAS[#bdbTankType[HG_Monococue]]:BEFORE[Bluedog_DB_3]
// {
// 	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]]
//     {
//         %currentSubtype = LF/O Monococue
//         @SUBTYPE[LF/O]
//         {
//             @name =  LF/O Monococue
//             @tankType = bdbLFOX_Monococue
//         }
//     }
//     @MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]]
//     {
//         %currentSubtype = Hypergolic Monococue
//         @SUBTYPE[Hypergolic]
//         {
//             @name = Hypergolic Monococue
//             @tankType = bdb_AZ50NTO_Monococue
//         }
//     }
// } 